<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450">
  <defs>
    <style>
      .label { font: 500 10px 'SF Mono', 'PingFang SC', monospace; fill: #666; text-anchor: middle; }
      .box-text { font: 600 12px 'SF Mono', 'PingFang SC', monospace; fill: #1a1a1a; text-anchor: middle; }
      .title { font: 700 16px 'SF Mono', 'PingFang SC', sans-serif; fill: #1a1a1a; text-anchor: middle; }
      .annotation { font: 400 9px 'SF Mono', 'PingFang SC', monospace; fill: #666; text-anchor: middle; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <marker id="blocked" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
  </defs>

  <rect width="800" height="450" fill="#fff"/>

  <text x="400" y="30" class="title">WASI 安全沙箱架构</text>
  <text x="400" y="47" class="label">WASI SECURITY SANDBOX ARCHITECTURE</text>

  <!-- Agent Core -->
  <rect x="80" y="100" width="180" height="60" fill="#FF6B6B" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="170" y="123" class="box-text" fill="#fff">Agent Core</text>
  <text x="170" y="138" class="label" fill="#fff">Rust</text>
  <text x="170" y="151" class="label" fill="#fff">安全层</text>

  <line x1="260" y1="130" x2="305" y2="130" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Wasmtime Runtime -->
  <rect x="310" y="80" width="180" height="100" fill="#fecaca" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="400" y="103" class="box-text">Wasmtime 运行时</text>
  <text x="400" y="118" class="label">Runtime</text>

  <rect x="330" y="130" width="140" height="40" fill="#ef4444" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="400" y="148" class="box-text" fill="#fff">隔离沙箱</text>
  <text x="400" y="161" class="label" fill="#fff">Isolated Sandbox</text>

  <line x1="490" y1="130" x2="535" y2="130" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Python WASI -->
  <rect x="540" y="100" width="180" height="60" fill="#4ECDC4" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="630" y="118" class="box-text" fill="#fff">Python 3.11</text>
  <text x="630" y="133" class="label" fill="#fff">WASI 解释器</text>
  <text x="630" y="148" class="label" fill="#fff">WASI Interpreter</text>

  <!-- User Code -->
  <rect x="565" y="190" width="130" height="40" fill="#d1fae5" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="630" y="208" class="box-text">用户代码</text>
  <text x="630" y="221" class="label">User Code</text>

  <line x1="630" y1="160" x2="630" y2="185" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Security Boundaries -->
  <!-- Network Stack - Blocked -->
  <rect x="80" y="250" width="160" height="60" fill="#fee2e2" stroke="#ef4444" stroke-width="1.5" rx="2"/>
  <text x="160" y="273" class="box-text">网络堆栈</text>
  <text x="160" y="288" class="label">Network Stack</text>
  <text x="160" y="301" class="annotation" fill="#ef4444">✗ 无访问 No Access</text>

  <line x1="470" y1="170" x2="240" y2="260" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="5,5" marker-end="url(#blocked)"/>

  <!-- Filesystem - Read-only -->
  <rect x="270" y="250" width="160" height="60" fill="#fed7aa" stroke="#f97316" stroke-width="1.5" rx="2"/>
  <text x="350" y="273" class="box-text">文件系统</text>
  <text x="350" y="288" class="label">Filesystem</text>
  <text x="350" y="301" class="annotation" fill="#ea580c">◐ 只读 Read-Only</text>

  <line x1="460" y1="175" x2="390" y2="245" stroke="#f97316" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrow)"/>

  <!-- Memory - Limited -->
  <rect x="460" y="250" width="160" height="60" fill="#d1fae5" stroke="#10b981" stroke-width="1.5" rx="2"/>
  <text x="540" y="273" class="box-text">内存</text>
  <text x="540" y="288" class="label">Memory</text>
  <text x="540" y="301" class="annotation" fill="#059669">✓ 有限 Limited</text>

  <line x1="510" y1="180" x2="540" y2="245" stroke="#10b981" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Configuration -->
  <rect x="50" y="350" width="700" height="80" fill="#f9fafb" stroke="#999" stroke-width="1" rx="2"/>
  <text x="400" y="368" class="label">安全配置 Security Configuration</text>

  <rect x="70" y="380" width="150" height="40" fill="#e5e7eb" stroke="#1a1a1a" stroke-width="1" rx="2"/>
  <text x="145" y="395" class="annotation" text-anchor="middle">内存限制 Memory Limit</text>
  <text x="145" y="410" class="annotation" text-anchor="middle">WASI_MEMORY_LIMIT_MB</text>

  <rect x="240" y="380" width="150" height="40" fill="#e5e7eb" stroke="#1a1a1a" stroke-width="1" rx="2"/>
  <text x="315" y="395" class="annotation" text-anchor="middle">执行超时 Timeout</text>
  <text x="315" y="410" class="annotation" text-anchor="middle">WASI_TIMEOUT_SECONDS</text>

  <rect x="410" y="380" width="150" height="40" fill="#e5e7eb" stroke="#1a1a1a" stroke-width="1" rx="2"/>
  <text x="485" y="395" class="annotation" text-anchor="middle">表限制 Table Limit</text>
  <text x="485" y="410" class="annotation" text-anchor="middle">DEFAULT_TABLE_LIMIT</text>

  <rect x="580" y="380" width="150" height="40" fill="#e5e7eb" stroke="#1a1a1a" stroke-width="1" rx="2"/>
  <text x="655" y="395" class="annotation" text-anchor="middle">解释器路径 Path</text>
  <text x="655" y="410" class="annotation" text-anchor="middle">PYTHON_WASI_WASM_PATH</text>
</svg>
