---
title: "Python SDK 安装"
description: "安装和配置 Shannon Python SDK"
---

## 安装

### 通过 pip（推荐）

```bash
pip install shannon-sdk
```

### 从源代码安装

```bash
git clone https://github.com/Kocoro-lab/Shannon.git
cd Shannon/clients/python
pip install -e .
```

### 要求

- Python 3.9 或更高版本
- pip 或 poetry 用于包管理

## 验证安装

```python
import shannon
print(shannon.__version__)
```

## 基本设置

### 导入客户端

```python
from shannon import ShannonClient

# 创建客户端实例（默认值：gRPC localhost:50052，SSE http://localhost:8081）
client = ShannonClient()
```

### 使用身份认证

```python
from shannon import ShannonClient

client = ShannonClient(api_key="sk_test_123456")
```

### 使用环境变量

SDK 不会自动读取环境变量。使用您自己的配置加载器或显式传递值：

```python
import os
from shannon import ShannonClient

client = ShannonClient(
    grpc_endpoint=os.getenv("SHANNON_GRPC_ENDPOINT", "localhost:50052"),
    api_key=os.getenv("SHANNON_API_KEY")
)
```

## 快速示例

```python
from shannon import ShannonClient

client = ShannonClient()

handle = client.submit_task(query="What is the capital of France?")
final = client.wait(handle.task_id, timeout=60)
print("Result:", final.result)
```

## 配置选项

### 客户端参数

| 参数 | 类型 | 默认值 | 描述 |
|-----------|------|---------|-------------|
| `grpc_endpoint` | str | `localhost:50052` | gRPC 端点（提交/状态/取消） |
| `http_endpoint` | str | `http://localhost:8081` | Orchestrator 管理端点，用于 SSE |
| `api_key` | str | None | API 密钥用于身份认证 |
| `timeout` | int | 300 | 默认请求超时时间（秒） |

### 完整配置

```python
client = ShannonClient(
    http_endpoint="http://localhost:8081",
    api_key="sk_live_123456",
    timeout=600,
    max_retries=5
)
```

## 异步客户端

对于异步应用，使用 `AsyncShannonClient`：

```python
from shannon import AsyncShannonClient
import asyncio

async def main():
    async with AsyncShannonClient() as client:
        handle = await client.submit_task(query="Analyze data")
        status = await client.wait(handle.task_id)
        print(status.result)

asyncio.run(main())
```

## 依赖项

SDK 自动安装：

- `grpcio` - gRPC 支持
- `protobuf` - 协议缓冲区序列化
- `requests` - HTTP 客户端
- `pydantic` - 数据验证

### 可选依赖项

```bash
# 用于异步支持
pip install shannon-sdk[async]

# 用于 CLI 工具
pip install shannon-sdk[cli]

# 所有扩展
pip install shannon-sdk[all]
```

## CLI 工具

该包包含一个简单的 CLI（`shannon`）。运行 `shannon --help` 查看用法。

## 故障排除

<AccordionGroup>
  <Accordion title="ImportError: No module named 'shannon'">
    **解决方案**：安装 SDK

    ```bash
    pip install shannon-sdk
    ```
  </Accordion>

  <Accordion title="Connection refused">
    **解决方案**：验证 Shannon 正在运行

    ```bash
    curl http://localhost:8080/health
    ```

    如果未运行，启动 Shannon：

    ```bash
    cd Shannon
    make dev
    ```
  </Accordion>

  <Accordion title="Authentication error">
    **解决方案**：检查 API 密钥

    ```python
    client = ShannonClient(
        http_endpoint="http://localhost:8080",
        api_key="sk_test_123456"  # 添加 API 密钥
    )
    ```
  </Accordion>

  <Accordion title="grpc module not found">
    **解决方案**：安装 grpcio

    ```bash
    pip install grpcio grpcio-tools
    ```
  </Accordion>
</AccordionGroup>

## 环境变量

SDK 识别这些环境变量：

| 变量 | 描述 | 示例 |
|----------|-------------|---------|
| `SHANNON_ENDPOINT` | HTTP 端点 | `http://localhost:8080` |
| `SHANNON_GRPC_ENDPOINT` | gRPC 端点 | `localhost:50052` |
| `SHANNON_API_KEY` | API 密钥 | `sk_test_123456` |
| `SHANNON_TIMEOUT` | 默认超时时间 | `300` |
| `SHANNON_LOG_LEVEL` | 日志级别 | `INFO` |

### .env 文件

创建 `.env` 文件：

```bash
SHANNON_ENDPOINT=http://localhost:8080
SHANNON_API_KEY=sk_test_123456
SHANNON_TIMEOUT=600
```

使用 python-dotenv 加载：

```python
from dotenv import load_dotenv
from shannon import ShannonClient

load_dotenv()

# 客户端使用 .env 值
client = ShannonClient()
```

## 日志记录

启用 SDK 日志记录：

```python
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger('shannon')
```

调试模式：

```python
import logging

logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
```

## 下一步

<CardGroup cols={2}>
  <Card title="快速入门" icon="rocket" href="/cn/sdk/python/quickstart">
    通过示例学习 SDK 基础
  </Card>
  <Card title="异步使用" icon="bolt" href="/cn/sdk/python/async-usage">
    异步/等待模式
  </Card>
  <Card title="示例" icon="code" href="/cn/sdk/python/examples">
    实际代码示例
  </Card>
</CardGroup>
