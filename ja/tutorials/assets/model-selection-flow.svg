<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 850">
  <defs>
    <style>
      .label { font: 500 9px 'SF Mono', 'Hiragino Sans', 'Noto Sans JP', sans-serif; fill: #666; text-anchor: middle; }
      .box-text { font: 600 11px 'SF Mono', 'Hiragino Sans', 'Noto Sans JP', sans-serif; fill: #1a1a1a; text-anchor: middle; dominant-baseline: middle; }
      .decision { font: 600 10px 'SF Mono', 'Hiragino Sans', 'Noto Sans JP', sans-serif; fill: #1a1a1a; text-anchor: middle; dominant-baseline: middle; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1000" height="850" fill="#fff"/>

  <!-- Task Submitted -->
  <ellipse cx="500" cy="40" rx="100" ry="30" fill="#e0f2fe" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="500" y="33" class="box-text">タスク提出</text>
  <text x="500" y="47" class="label">Task Submitted</text>

  <!-- model_override? -->
  <path d="M 500 100 L 570 140 L 500 180 L 430 140 Z" fill="#ffedd5" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="500" y="137" class="decision">model_override</text>
  <text x="500" y="148" class="decision">はあるか?</text>

  <!-- Use Specific Model -->
  <rect x="680" y="120" width="140" height="40" fill="#d1fae5" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="750" y="133" class="box-text">特定のモデル使用</text>
  <text x="750" y="148" class="label">Use Specific Model</text>

  <!-- provider_override? -->
  <path d="M 500 210 L 570 250 L 500 290 L 430 250 Z" fill="#dbeafe" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="500" y="247" class="decision">provider_override</text>
  <text x="500" y="258" class="decision">はあるか?</text>

  <!-- Filter by Provider -->
  <rect x="680" y="230" width="160" height="40" fill="#bfdbfe" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="760" y="243" class="box-text">プロバイダーフィルタ</text>
  <text x="760" y="258" class="label">Filter by Provider</text>

  <!-- model_tier? -->
  <path d="M 500 320 L 570 360 L 500 400 L 430 360 Z" fill="#fef3c7" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="500" y="357" class="decision">model_tier</text>
  <text x="500" y="368" class="decision">はあるか?</text>

  <!-- Use Requested Tier -->
  <rect x="680" y="340" width="160" height="40" fill="#fde047" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="760" y="353" class="box-text">リクエストティア使用</text>
  <text x="760" y="368" class="label">Use Requested Tier</text>

  <!-- Analyze Complexity -->
  <rect x="420" y="440" width="160" height="40" fill="#fed7aa" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="500" y="453" class="box-text">複雑さを分析</text>
  <text x="500" y="468" class="label">Analyze Complexity</text>

  <!-- Complexity Score -->
  <path d="M 500 510 L 580 560 L 500 610 L 420 560 Z" fill="#ffedd5" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="500" y="557" class="decision">複雑さ</text>
  <text x="500" y="568" class="decision">スコア</text>

  <!-- Small Tier -->
  <rect x="150" y="660" width="120" height="40" fill="#bbf7d0" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="210" y="673" class="box-text">Smallティア</text>
  <text x="210" y="688" class="label">{"< 0.3"}</text>

  <!-- Medium Tier -->
  <rect x="320" y="660" width="120" height="40" fill="#fde047" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="380" y="673" class="box-text">Mediumティア</text>
  <text x="380" y="688" class="label">0.3-0.7</text>

  <!-- Large Tier -->
  <rect x="490" y="660" width="120" height="40" fill="#fecaca" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="550" y="673" class="box-text">Largeティア</text>
  <text x="550" y="688" class="label">{"> 0.7"}</text>

  <!-- Priority Ranking -->
  <rect x="420" y="740" width="160" height="40" fill="#c7d2fe" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="500" y="753" class="box-text">優先順位ランキング</text>
  <text x="500" y="768" class="label">Priority Ranking</text>

  <!-- Select Best -->
  <rect x="390" y="810" width="220" height="40" fill="#e9d5ff" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="500" y="823" class="box-text">利用可能な最高優先順位を選択</text>
  <text x="500" y="838" class="label">Select Best Available Priority</text>

  <!-- API Call Success? -->
  <path d="M 750 770 L 830 810 L 750 850 L 670 810 Z" fill="#dbeafe" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="750" y="807" class="decision">API成功?</text>
  <text x="750" y="818" class="decision">Success?</text>

  <!-- Execute Task -->
  <ellipse cx="920" cy="750" rx="70" ry="30" fill="#d1fae5" stroke="#16a34a" stroke-width="2"/>
  <text x="920" cy="743" class="box-text" fill="#16a34a">タスク実行</text>
  <text x="920" cy="757" class="label" fill="#16a34a">Execute</text>

  <!-- Try Next -->
  <rect x="690" y="900" width="120" height="40" fill="#fed7aa" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="750" y="913" class="box-text">次を試す</text>
  <text x="750" y="928" class="label">Try Next Priority</text>

  <!-- Arrows -->
  <line x1="500" y1="70" x2="500" y2="95" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Yes override -->
  <line x1="570" y1="140" x2="675" y2="140" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="620" y="132" class="label">はい / Yes</text>

  <!-- No -->
  <line x1="430" y1="140" x2="350" y2="140" stroke="#666" stroke-width="1.5"/>
  <line x1="350" y1="140" x2="350" y2="250" stroke="#666" stroke-width="1.5"/>
  <line x1="350" y1="250" x2="425" y2="250" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="370" y="132" class="label">いいえ / No</text>

  <!-- Yes provider -->
  <line x1="570" y1="250" x2="675" y2="250" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="620" y="242" class="label">はい / Yes</text>

  <!-- No provider -->
  <line x1="430" y1="250" x2="350" y2="250" stroke="#666" stroke-width="1.5"/>
  <line x1="350" y1="250" x2="350" y2="360" stroke="#666" stroke-width="1.5"/>
  <line x1="350" y1="360" x2="425" y2="360" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="370" y="300" class="label">いいえ / No</text>

  <!-- Yes tier -->
  <line x1="570" y1="360" x2="675" y2="360" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="620" y="352" class="label">はい / Yes</text>

  <!-- No tier -->
  <line x1="430" y1="360" x2="350" y2="360" stroke="#666" stroke-width="1.5"/>
  <line x1="350" y1="360" x2="350" y2="460" stroke="#666" stroke-width="1.5"/>
  <line x1="350" y1="460" x2="415" y2="460" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="370" y="410" class="label">いいえ / No</text>

  <line x1="500" y1="480" x2="500" y2="505" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Complexity branches -->
  <line x1="440" y1="585" x2="230" y2="655" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="480" y1="590" x2="365" y2="655" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="520" y1="590" x2="535" y2="655" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Tier to Ranking -->
  <line x1="760" y1="380" x2="760" y2="760" stroke="#666" stroke-width="1.5"/>
  <line x1="760" y1="760" x2="585" y2="760" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="760" y1="270" x2="890" y2="270" stroke="#666" stroke-width="1.5"/>
  <line x1="890" y1="270" x2="890" y2="760" stroke="#666" stroke-width="1.5"/>
  <line x1="890" y1="760" x2="585" y2="760" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="210" y1="700" x2="480" y2="755" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="380" y1="700" x2="490" y2="735" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="550" y1="700" x2="505" y2="735" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="500" y1="780" x2="665" y2="805" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Yes Success -->
  <line x1="830" y1="790" x2="910" y2="760" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="870" y="770" class="label">はい / Yes</text>

  <!-- No Success -->
  <line x1="750" y1="850" x2="750" y2="895" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="770" y="870" class="label">いいえ / No</text>

  <line x1="690" y1="920" x2="650" y2="920" stroke="#666" stroke-width="1.5"/>
  <line x1="650" y1="920" x2="650" y2="810" stroke="#666" stroke-width="1.5"/>
  <line x1="650" y1="810" x2="665" y2="810" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
</svg>
