<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 650">
  <defs>
    <style>
      .label { font: 500 10px 'SF Mono', 'Hiragino Sans', 'Noto Sans JP', sans-serif; fill: #666; text-anchor: middle; }
      .box-text { font: 600 12px 'SF Mono', 'Hiragino Sans', 'Noto Sans JP', sans-serif; fill: #1a1a1a; text-anchor: middle; dominant-baseline: middle; }
      .msg-text { font: 500 9px 'SF Mono', 'Hiragino Sans', 'Noto Sans JP', sans-serif; fill: #666; text-anchor: middle; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <marker id="arrow-back" markerWidth="10" markerHeight="7" refX="1" refY="3.5" orient="auto">
      <polygon points="10 0, 0 3.5, 10 7" fill="#999"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="650" fill="#fff"/>

  <!-- Participants -->
  <!-- Orch -->
  <rect x="50" y="30" width="100" height="40" fill="#00A3FF" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="100" y="50" class="box-text">Orch</text>
  <line x1="100" y1="70" x2="100" y2="620" stroke="#ddd" stroke-width="1" stroke-dasharray="4,4"/>

  <!-- Agent -->
  <rect x="200" y="30" width="100" height="40" fill="#FF6B6B" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="250" y="50" class="box-text" fill="#fff">Agent</text>
  <line x1="250" y1="70" x2="250" y2="620" stroke="#ddd" stroke-width="1" stroke-dasharray="4,4"/>

  <!-- LLM -->
  <rect x="350" y="30" width="100" height="40" fill="#4ECDC4" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="400" y="50" class="box-text">LLM</text>
  <line x1="400" y1="70" x2="400" y2="620" stroke="#ddd" stroke-width="1" stroke-dasharray="4,4"/>

  <!-- Adapter -->
  <rect x="500" y="30" width="120" height="40" fill="#a7f3d0" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="560" y="50" class="box-text">Vendor Adapter</text>
  <line x1="560" y1="70" x2="560" y2="620" stroke="#ddd" stroke-width="1" stroke-dasharray="4,4"/>

  <!-- API -->
  <rect x="670" y="30" width="120" height="40" fill="#bfdbfe" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="730" y="50" class="box-text">External API</text>
  <line x1="730" y1="70" x2="730" y2="620" stroke="#ddd" stroke-width="1" stroke-dasharray="4,4"/>

  <!-- Messages -->
  <!-- 1. Orch to Agent -->
  <line x1="100" y1="100" x2="240" y2="100" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="170" y="92" class="msg-text">ツール実行</text>
  <text x="170" y="108" class="msg-text">(body, operation)</text>

  <!-- 2. Agent to LLM -->
  <line x1="250" y1="140" x2="390" y2="140" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="320" y="132" class="msg-text">ツールリクエスト</text>
  <text x="320" y="148" class="msg-text">(body)</text>

  <!-- Alt box -->
  <rect x="370" y="170" width="410" height="200" fill="none" stroke="#999" stroke-width="1" stroke-dasharray="4,4" rx="2"/>
  <text x="380" y="188" class="label" fill="#999">alt [ベンダーアダプターが設定されている]</text>

  <!-- 3. LLM to Adapter -->
  <line x1="400" y1="210" x2="550" y2="210" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="475" y="202" class="msg-text">transform_body</text>
  <text x="475" y="218" class="msg-text">(body, operation, params)</text>

  <!-- 4. Adapter internal -->
  <rect x="530" y="240" width="60" height="60" fill="#e0f2fe" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="560" y="258" class="msg-text">フィールド</text>
  <text x="560" y="268" class="msg-text">エイリアス</text>
  <text x="560" y="278" class="msg-text">セッション注入</text>
  <text x="560" y="288" class="msg-text">正規化</text>

  <!-- 5. Adapter to LLM -->
  <line x1="550" y1="320" x2="410" y2="320" stroke="#999" stroke-width="1.5" marker-end="url(#arrow-back)" stroke-dasharray="3,3"/>
  <text x="480" y="312" class="msg-text">変換された body</text>

  <!-- 6. LLM to API -->
  <line x1="400" y1="390" x2="720" y2="390" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="560" y="382" class="msg-text">HTTP リクエスト</text>
  <text x="560" y="398" class="msg-text">(変換された body)</text>

  <!-- 7. API to LLM -->
  <line x1="720" y1="430" x2="410" y2="430" stroke="#999" stroke-width="1.5" marker-end="url(#arrow-back)" stroke-dasharray="3,3"/>
  <text x="565" y="422" class="msg-text">レスポンス</text>

  <!-- 8. LLM to Agent -->
  <line x1="390" y1="470" x2="260" y2="470" stroke="#999" stroke-width="1.5" marker-end="url(#arrow-back)" stroke-dasharray="3,3"/>
  <text x="325" y="462" class="msg-text">ツール結果</text>

  <!-- 9. Agent to Orch -->
  <line x1="240" y1="510" x2="110" y2="510" stroke="#999" stroke-width="1.5" marker-end="url(#arrow-back)" stroke-dasharray="3,3"/>
  <text x="175" y="502" class="msg-text">結果</text>
</svg>
