---
title: "API Overview"
description: "Shannon's REST and gRPC APIs for AI agent orchestration"
---

## Introduction

Shannon provides HTTP REST and gRPC APIs for submitting tasks, streaming results, and managing AI agent workflows.

**Base URL**: `http://localhost:8080` (development)

## Quick Start

```bash
# Submit a task
curl -X POST http://localhost:8080/api/v1/tasks \
  -H "Content-Type: application/json" \
  -d '{"query": "Analyze sentiment: Shannon makes AI simple"}'

# Response
{
  "task_id": "task-dev-1234567890",
  "status": "submitted",
  "created_at": "2025-01-20T10:00:00Z"
}

# Stream real-time events
curl -N "http://localhost:8080/api/v1/stream/sse?workflow_id=task-dev-1234567890"
```

## API Endpoints

### Core Task Operations

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/tasks` | POST | Submit a new task |
| `/api/v1/tasks/stream` | POST | Submit task and get stream URL (201) |
| `/api/v1/tasks` | GET | List tasks with filters |
| `/api/v1/tasks/{id}` | GET | Get task status and result |
| `/api/v1/tasks/{id}/events` | GET | Get task event history |
| `/api/v1/tasks/{id}/timeline` | GET | Get Temporal execution timeline |

### Real-Time Streaming

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/stream/sse?workflow_id={id}` | GET | Server-Sent Events stream |
| `/api/v1/stream/ws?workflow_id={id}` | GET | WebSocket stream |

### Session Management

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/sessions` | GET | List sessions with pagination |
| `/api/v1/sessions/{sessionId}` | GET | Get session details |
| `/api/v1/sessions/{sessionId}/history` | GET | Get session chat history |
| `/api/v1/sessions/{sessionId}/events` | GET | Get session events (excludes LLM_PARTIAL) |
| `/api/v1/sessions/{sessionId}` | DELETE | Delete session (soft delete; 204 idempotent) |

### Health & Observability

| Endpoint | Method | Description | Auth Required |
|----------|--------|-------------|---------------|
| `/health` | GET | Health check | No |
| `/readiness` | GET | Readiness probe | No |
| `/openapi.json` | GET | OpenAPI 3.0 spec | No |

## Authentication

<Note>
**Development Default**: Authentication is **disabled** (`GATEWAY_SKIP_AUTH=1`). Enable for production.
</Note>

When enabled, pass API key via header:

```bash
curl -H "X-API-Key: sk_test_123456" \
  http://localhost:8080/api/v1/tasks
```

<Warning>
**SSE Streaming**: Browser `EventSource` doesn't support custom headers. Pass API key as query parameter:
```
/api/v1/stream/sse?workflow_id={id}&api_key=sk_test_123456
```
</Warning>

## Response Format

All endpoints return JSON with consistent error format:

**Success (200)**:
```json
{
  "task_id": "task-dev-1234567890",
  "status": "COMPLETED",
  "result": "Sentiment: Positive"
}
```

**Error (400/401/404/429/500)**:
```json
{
  "error": "Task not found"
}
```

## Rate Limiting

- **Default**: 60 requests/minute per API key
- **Headers**: `X-RateLimit-Limit`, `X-RateLimit-Remaining`, `X-RateLimit-Reset`
- **429 Response**: Includes `Retry-After` header

## Event Streaming

Shannon emits 26 event types for real-time monitoring:

**Core Events**:
- `WORKFLOW_STARTED`, `WORKFLOW_COMPLETED`
- `AGENT_STARTED`, `AGENT_COMPLETED`, `AGENT_THINKING`
- `PROGRESS`, `DATA_PROCESSING`
- `ERROR_OCCURRED`

**LLM Events**:
- `LLM_PROMPT`, `LLM_OUTPUT`, `LLM_PARTIAL`

**Tool Events**:
- `TOOL_INVOKED`, `TOOL_OBSERVATION`

See [Event Types Reference](/en/api/rest/streaming#event-types) for complete list.

## gRPC API

For performance-critical applications, use gRPC:

**Endpoint**: `localhost:50052`

**Services**:
- `OrchestratorService` - Task submission and management
- `StreamingService` - Real-time event streaming
- `SessionService` - Session context management

**Example**:
```python
import grpc
from shannon.generated import orchestrator_pb2_grpc

channel = grpc.insecure_channel('localhost:50052')
stub = orchestrator_pb2_grpc.OrchestratorServiceStub(channel)

request = orchestrator_pb2.SubmitTaskRequest(
    metadata=orchestrator_pb2.TaskMetadata(user_id="user-123"),
    query="Analyze sentiment"
)

response = stub.SubmitTask(request)
```

## Best Practices

### 1. Use Session IDs for Context

```json
{
  "query": "What about Q2?",
  "session_id": "user-123-analytics"
}
```

### 2. Stream Events for Long Tasks

```python
import requests

r = requests.get(
    f"http://localhost:8080/api/v1/stream/sse?workflow_id={task_id}",
    stream=True
)

for line in r.iter_lines():
    if line:
        event = parse_sse(line)
        print(event['type'])
```

### 3. Handle Rate Limits

```python
import time

def submit_with_retry(query, max_retries=3):
    for attempt in range(max_retries):
        response = requests.post(url, json={"query": query})

        if response.status_code == 429:
            retry_after = int(response.headers.get("Retry-After", 60))
            time.sleep(retry_after)
            continue

        return response
```

### 4. Use Idempotency Keys

```bash
curl -X POST http://localhost:8080/api/v1/tasks \
  -H "Idempotency-Key: $(uuidgen)" \
  -d '{"query": "Process once"}'
```

## SDKs

<CardGroup cols={2}>
  <Card title="Python SDK" icon="python" href="/en/sdk/python/quickstart">
    Official Python client with streaming support
  </Card>
  <Card title="REST Clients" icon="code">
    Use any HTTP client library
  </Card>
</CardGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="Submit Tasks" icon="paper-plane" href="/en/api/rest/submit-task">
    Task submission API
  </Card>
  <Card title="Stream Events" icon="stream" href="/en/api/rest/streaming">
    Real-time event streaming
  </Card>
  <Card title="Sessions API" icon="messages" href="/en/api/rest/sessions">
    Session management
  </Card>
  <Card title="Python SDK" icon="python" href="/en/sdk/python/quickstart">
    Get started with Python
  </Card>
</CardGroup>
