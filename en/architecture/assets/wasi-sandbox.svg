<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 350">
  <defs>
    <style>
      .label { font: 500 10px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #666; text-anchor: middle; letter-spacing: 0.5px; }
      .box-text { font: 600 13px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .box-text-sm { font: 600 11px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .title { font: 700 16px 'SF Mono', 'PingFang SC', sans-serif; fill: #1a1a1a; text-anchor: middle; }
      .denied { font: 700 11px 'SF Mono', monospace; fill: #dc2626; text-anchor: middle; }
      .allowed { font: 700 11px 'SF Mono', monospace; fill: #059669; text-anchor: middle; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <marker id="arrow-denied" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#dc2626"/>
    </marker>
  </defs>

  <rect width="700" height="350" fill="#fff"/>
  <text x="350" y="30" class="title">WASI Sandbox Security</text>

  <!-- Agent Core -->
  <rect x="50" y="80" width="150" height="60" fill="#fde047" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="125" y="103" class="box-text">Agent Core</text>
  <text x="125" y="123" class="label">Rust</text>

  <!-- Wasmtime Runtime -->
  <rect x="250" y="80" width="150" height="60" fill="#a5f3fc" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="325" y="110" class="box-text">Wasmtime Runtime</text>

  <!-- Python WASI Interpreter -->
  <rect x="450" y="80" width="180" height="60" fill="#99f6e4" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="540" y="103" class="box-text-sm">Python 3.11</text>
  <text x="540" y="118" class="label">WASI Interpreter</text>
  <text x="540" y="133" class="label">User Code Execution</text>

  <!-- Blocked Resources -->
  <!-- Network Stack -->
  <rect x="450" y="200" width="120" height="50" fill="#fecaca" stroke="#dc2626" stroke-width="2" rx="2"/>
  <text x="510" y="225" class="box-text-sm">Network Stack</text>
  <text x="510" y="240" class="denied">NO ACCESS</text>

  <!-- Filesystem -->
  <rect x="450" y="270" width="120" height="50" fill="#fde68a" stroke="#f59e0b" stroke-width="2" rx="2"/>
  <text x="510" y="295" class="box-text-sm">Filesystem</text>
  <text x="510" y="310" class="denied">READ-ONLY</text>

  <!-- Memory -->
  <rect x="250" y="200" width="120" height="50" fill="#bbf7d0" stroke="#059669" stroke-width="2" rx="2"/>
  <text x="310" y="225" class="box-text-sm">Memory</text>
  <text x="310" y="240" class="allowed">LIMITED</text>

  <!-- Arrows -->
  <line x1="200" y1="110" x2="245" y2="110" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="400" y1="110" x2="445" y2="110" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Denied connections -->
  <line x1="540" y1="140" x2="540" y2="170" stroke="#dc2626" stroke-width="2" stroke-dasharray="4"/>
  <line x1="540" y1="170" x2="510" y2="170" stroke="#dc2626" stroke-width="2" stroke-dasharray="4"/>
  <line x1="510" y1="170" x2="510" y2="195" stroke="#dc2626" stroke-width="2" stroke-dasharray="4" marker-end="url(#arrow-denied)"/>

  <line x1="540" y1="170" x2="510" y2="170" stroke="#dc2626" stroke-width="2" stroke-dasharray="4"/>
  <line x1="510" y1="170" x2="510" y2="265" stroke="#dc2626" stroke-width="2" stroke-dasharray="4" marker-end="url(#arrow-denied)"/>

  <!-- Limited connection -->
  <line x1="325" y1="140" x2="325" y2="170" stroke="#059669" stroke-width="2"/>
  <line x1="325" y1="170" x2="310" y2="170" stroke="#059669" stroke-width="2"/>
  <line x1="310" y1="170" x2="310" y2="195" stroke="#059669" stroke-width="2" marker-end="url(#arrow)"/>
</svg>
