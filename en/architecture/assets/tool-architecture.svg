<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 600">
  <defs>
    <style>
      .label { font: 500 10px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #666; text-anchor: middle; letter-spacing: 0.5px; }
      .box-text { font: 600 13px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .box-text-sm { font: 600 11px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .title { font: 700 16px 'SF Mono', 'PingFang SC', sans-serif; fill: #1a1a1a; text-anchor: middle; }
      .group-title { font: 700 12px 'SF Mono', monospace; fill: #1a1a1a; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>

  <rect width="700" height="600" fill="#fff"/>
  <text x="350" y="30" class="title">Tool Execution Architecture</text>

  <!-- Orchestrator (Go) Group -->
  <rect x="50" y="60" width="200" height="180" fill="#f0f9ff" stroke="#666" stroke-width="1" rx="3"/>
  <text x="60" y="80" class="group-title">Orchestrator (Go)</text>

  <rect x="70" y="95" width="160" height="40" fill="#dbeafe" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="150" y="120" class="box-text-sm">Workflow</text>

  <rect x="70" y="145" width="160" height="40" fill="#dbeafe" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="150" y="163" class="box-text-sm">Tool Selection</text>
  <text x="150" y="177" class="box-text-sm">Budget Check</text>

  <rect x="70" y="195" width="160" height="35" fill="#dbeafe" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="150" y="217" class="box-text-sm">Execute Tool Activity</text>

  <!-- Agent Core (Rust) Group -->
  <rect x="290" y="60" width="190" height="280" fill="#fef3c7" stroke="#666" stroke-width="1" rx="3"/>
  <text x="300" y="80" class="group-title">Agent Core (Rust)</text>

  <rect x="310" y="95" width="150" height="40" fill="#fde047" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="385" y="120" class="box-text-sm">Tool Registry</text>

  <!-- Tool Type Decision -->
  <path d="M 385 150 L 445 180 L 385 210 L 325 180 Z" fill="#fde047" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="385" y="183" class="box-text-sm">Tool Type?</text>

  <rect x="310" y="225" width="150" height="35" fill="#fde047" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="385" y="247" class="box-text-sm">Python WASI Sandbox</text>

  <rect x="310" y="270" width="150" height="35" fill="#fde047" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="385" y="292" class="box-text-sm">Circuit Breaker</text>

  <!-- LLM Service (Python) Group -->
  <rect x="520" y="60" width="150" height="240" fill="#d1fae5" stroke="#666" stroke-width="1" rx="3"/>
  <text x="530" y="80" class="group-title">LLM Service (Python)</text>

  <rect x="535" y="95" width="120" height="40" fill="#99f6e4" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="595" y="120" class="box-text-sm">Tool Implementation</text>

  <rect x="535" y="145" width="120" height="40" fill="#99f6e4" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="595" y="163" class="box-text-sm">Vendor</text>
  <text x="595" y="177" class="box-text-sm">Adapter</text>

  <rect x="535" y="195" width="120" height="40" fill="#99f6e4" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="595" y="220" class="box-text-sm">External API</text>

  <!-- Result -->
  <rect x="290" y="360" width="190" height="35" fill="#e5e7eb" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="385" y="382" class="box-text-sm">Result</text>

  <!-- Arrows -->
  <line x1="150" y1="135" x2="150" y2="140" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="150" y1="185" x2="150" y2="190" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="230" y1="212" x2="305" y2="212" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="385" y1="135" x2="385" y2="145" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Built-in -->
  <line x1="385" y1="210" x2="385" y2="220" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="405" y="218" class="label">Built-in</text>

  <!-- MCP -->
  <line x1="445" y1="180" x2="530" y2="180" stroke="#666" stroke-width="1.5"/>
  <line x1="530" y1="180" x2="530" y2="165" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="487" y="175" class="label">MCP</text>

  <!-- OpenAPI -->
  <line x1="325" y1="180" x2="270" y2="180" stroke="#666" stroke-width="1.5"/>
  <line x1="270" y1="180" x2="270" y2="420" stroke="#666" stroke-width="1.5"/>
  <line x1="270" y1="420" x2="530" y2="420" stroke="#666" stroke-width="1.5"/>
  <line x1="530" y1="420" x2="530" y2="215" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="315" y="175" class="label">OpenAPI</text>

  <line x1="385" y1="260" x2="385" y2="265" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="595" y1="135" x2="595" y2="140" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="595" y1="185" x2="595" y2="190" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="460" y1="287" x2="530" y2="287" stroke="#666" stroke-width="1.5"/>
  <line x1="530" y1="287" x2="530" y2="115" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="385" y1="305" x2="385" y2="355" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="385" y1="395" x2="385" y2="440" stroke="#666" stroke-width="1.5"/>
  <line x1="385" y1="440" x2="150" y2="440" stroke="#666" stroke-width="1.5"/>
  <line x1="150" y1="440" x2="150" y2="235" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
</svg>
