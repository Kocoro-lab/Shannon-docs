<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 900">
  <defs>
    <style>
      .label { font: 500 10px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #666; text-anchor: middle; letter-spacing: 0.5px; }
      .box-text { font: 600 13px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .box-text-sm { font: 600 11px 'SF Mono', 'Menlo', 'Monaco', monospace; fill: #1a1a1a; text-anchor: middle; }
      .title { font: 700 16px 'SF Mono', 'PingFang SC', sans-serif; fill: #1a1a1a; text-anchor: middle; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="850" height="900" fill="#fff"/>

  <!-- Title -->
  <text x="425" y="30" class="title">Research Workflow</text>

  <!-- User Query -->
  <rect x="345" y="60" width="160" height="40" fill="#fef3c7" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="425" y="85" class="box-text">User Query</text>

  <!-- Memory Retrieval -->
  <rect x="325" y="130" width="200" height="40" fill="#dbeafe" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="425" y="155" class="box-text-sm">Memory Retrieval</text>

  <!-- Session check -->
  <path d="M 345 210 L 505 210 L 525 230 L 505 250 L 345 250 L 325 230 Z" fill="#a5f3fc" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="425" y="233" class="box-text-sm">Large Context?</text>

  <!-- Context Compression -->
  <rect x="580" y="210" width="180" height="40" fill="#fed7aa" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="670" y="235" class="box-text-sm">Context Compression</text>

  <!-- Query Refinement -->
  <rect x="315" y="290" width="220" height="40" fill="#99f6e4" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="425" y="315" class="box-text-sm">Query Refinement</text>

  <!-- Decomposition -->
  <rect x="335" y="360" width="180" height="40" fill="#fde047" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="425" y="385" class="box-text-sm">Decomposition</text>

  <!-- Execution Pattern -->
  <path d="M 345 440 L 505 440 L 525 460 L 505 480 L 345 480 L 325 460 Z" fill="#d1fae5" stroke="#1a1a1a" stroke-width="1.5"/>
  <text x="425" y="463" class="box-text-sm">Execution Pattern</text>

  <!-- Patterns -->
  <rect x="50" y="530" width="140" height="50" fill="#fbcfe8" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="120" y="548" class="box-text-sm">React</text>
  <text x="120" y="563" class="label">＜ 0.5</text>

  <rect x="220" y="530" width="140" height="50" fill="#fbcfe8" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="290" y="548" class="box-text-sm">Parallel</text>
  <text x="290" y="563" class="label">No deps</text>

  <rect x="390" y="530" width="140" height="50" fill="#fbcfe8" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="460" y="548" class="box-text-sm">Hybrid</text>
  <text x="460" y="563" class="label">Has deps</text>

  <rect x="560" y="530" width="140" height="50" fill="#fbcfe8" stroke="#1a1a1a" stroke-width="1.5" rx="2"/>
  <text x="630" y="548" class="box-text-sm">React Per Task</text>
  <text x="630" y="563" class="label">＞ 0.7 + Deep</text>

  <!-- Entity Filtering -->
  <rect x="315" y="620" width="220" height="40" fill="#f9a8d4" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="425" y="645" class="box-text-sm">Entity Filtering</text>

  <!-- Citation Collection -->
  <rect x="315" y="690" width="220" height="40" fill="#e5e7eb" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="425" y="715" class="box-text-sm">Citation Collection</text>

  <!-- Gap Filling -->
  <rect x="335" y="760" width="180" height="40" fill="#fed7aa" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="425" y="785" class="box-text-sm">Gap Filling</text>

  <!-- Synthesis -->
  <rect x="345" y="830" width="160" height="40" fill="#dbeafe" stroke="#1a1a1a" stroke-width="1.5" rx="4"/>
  <text x="425" y="855" class="box-text-sm">Synthesis</text>

  <!-- Arrows -->
  <line x1="425" y1="100" x2="425" y2="125" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="425" y1="170" x2="425" y2="205" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Yes path -->
  <line x1="525" y1="230" x2="575" y2="230" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="550" y="225" class="label">Yes</text>

  <line x1="670" y1="250" x2="670" y2="270" stroke="#666" stroke-width="1.5"/>
  <line x1="670" y1="270" x2="425" y2="270" stroke="#666" stroke-width="1.5"/>
  <line x1="425" y1="270" x2="425" y2="285" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- No path -->
  <line x1="425" y1="250" x2="425" y2="285" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="445" y="270" class="label">No</text>

  <line x1="425" y1="330" x2="425" y2="355" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="425" y1="400" x2="425" y2="435" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Pattern branches -->
  <line x1="325" y1="460" x2="120" y2="525" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="360" y1="480" x2="290" y2="525" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="460" y1="480" x2="460" y2="525" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="525" y1="460" x2="630" y2="525" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Converge to Entity Filtering -->
  <line x1="120" y1="580" x2="315" y2="640" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="290" y1="580" x2="360" y2="615" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="460" y1="580" x2="460" y2="615" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="630" y1="580" x2="535" y2="640" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="425" y1="660" x2="425" y2="685" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="425" y1="730" x2="425" y2="755" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="425" y1="800" x2="425" y2="825" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
</svg>
